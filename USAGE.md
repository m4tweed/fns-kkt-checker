# Руководство по использованию

## Запуск приложения

### Вариант 1: Быстрый старт (рекомендуется)

```bash
./start.sh
```

### Вариант 2: Ручной запуск

```bash
# 1. Установите зависимости (только первый раз)
pip3 install --user -r requirements.txt

# 2. Запустите сервер
python3 server.py

# 3. Откройте в браузере
# http://localhost:5001
```

## Использование веб-интерфейса

### Шаг 1: Выберите модель ККТ
Из выпадающего списка выберите одну из доступных моделей:
- **БФР-112ФС** (код: 0189)
- **MicroPay-ФАС** (код: 0124)
- **СК-1** (код: 0244)

### Шаг 2: Введите заводские номера
Введите заводские номера ККТ в текстовое поле, каждый номер на отдельной строке:

```
19923200300211111
19923200300024029
19923200300027105
```

### Шаг 3: Нажмите "Проверить кассы"
Приложение последовательно проверит каждый номер через API ФНС.

### Шаг 4: Изучите результаты
После проверки вы увидите:

#### Статистика
- **Всего проверено** - количество проверенных номеров и модель
- **В реестре** - количество касс, найденных в реестре ФНС
- **Не в реестре** - количество касс, отсутствующих в реестре

#### Таблица результатов
Для каждого номера показывается:
- Порядковый номер
- Заводской номер ККТ
- Статус (В реестре / Не в реестре)
- Детальное описание от API ФНС

## Возможные статусы

### ✅ В реестре
**check_status: 1**
```
Экземпляр ККТ включен в реестр ККТ
```
ККТ зарегистрирована и находится в официальном реестре ФНС.

### ❌ Не в реестре
**check_status: 0**
```
Заводской номер ККТ отсутствует в реестре произведенных экземпляров ККТ
```
ККТ с таким номером не найдена в реестре. Возможные причины:
- Номер введен неправильно
- ККТ еще не произведена
- ККТ снята с учета

## Примеры использования

### Проверка одной кассы
```
Модель: БФР-112ФС
Номер: 19923200300211111
```

### Массовая проверка
```
Модель: БФР-112ФС
Номера:
19923200300211111
19923200300024029
19923200300027105
19923200300456789
19923200300987654
```

## Особенности работы

### Скорость проверки
- Примерно 0.3 секунды на один номер
- 10 номеров ≈ 3-5 секунд
- 100 номеров ≈ 30-60 секунд

### Ограничения
- Максимально рекомендуется проверять до 200 номеров за раз
- При большем количестве разделите на несколько проверок
- Сервер контролирует частоту запросов к API ФНС

### Надежность
- Приложение использует официальное API ФНС
- При ошибках соединения показывается соответствующее сообщение
- Все запросы логируются на сервере

## API для программистов

### POST /api/kkt/check
Проверить один заводской номер

**Запрос:**
```json
{
  "model_code": "0189",
  "factory_number": "19923200300211111"
}
```

**Ответ:**
```json
{
  "status": 1,
  "check_status": 0,
  "check_result": "Заводской номер ККТ отсутствует в реестре произведенных экземпляров ККТ"
}
```

### POST /api/kkt/check-batch
Проверить несколько номеров

**Запрос:**
```json
{
  "model_code": "0189",
  "factory_numbers": [
    "19923200300211111",
    "19923200300024029"
  ]
}
```

**Ответ:**
```json
{
  "results": [
    {
      "factory_number": "19923200300211111",
      "status": 1,
      "check_status": 0,
      "check_result": "Заводской номер ККТ отсутствует в реестре..."
    },
    ...
  ]
}
```

## Решение проблем

### Сервер не запускается
```bash
# Проверьте, не занят ли порт
lsof -i :5001

# Убейте процесс, если порт занят
kill -9 <PID>
```

### Ошибки установки зависимостей
```bash
# Попробуйте установить в виртуальное окружение
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
# или
venv\Scripts\activate  # Windows
pip install -r requirements.txt
python server.py
```

### API не отвечает
- Проверьте подключение к интернету
- Убедитесь, что сайт kkt-online.nalog.ru доступен
- Проверьте логи сервера в терминале

## Техническая поддержка

При возникновении проблем проверьте:
1. Версию Python (должна быть 3.7+)
2. Установлены ли все зависимости
3. Доступен ли порт 5001
4. Есть ли подключение к интернету
5. Логи сервера в терминале

---

**Разработано для упрощения массовой проверки ККТ в реестре ФНС России**
